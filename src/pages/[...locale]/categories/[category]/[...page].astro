---
import i18n from "i18next";
import { normalize } from "@/lib/normalize";
import { getThemeConfig } from "../../../../config";
import BlogIndex from "../../../../layouts/blog-index.astro";
import { findMenuItemById } from "../../../../lib/menu";
import {
  getCategoryStaticPaths,
  getPaginationConfig,
} from "../../../../lib/posts";

export async function getStaticPaths({ paginate }: { paginate: any }) {
  return await getCategoryStaticPaths({ paginate });
}

const { page } = Astro.props;
const { category } = Astro.params;

const cat = findMenuItemById(category, i18n.language);
const linkPrefix = normalize(cat?.href || `/categories/${category}`);
const { prefix: paginationPrefix } = getPaginationConfig();
---

<BlogIndex
  title={cat?.name}
  items={page.data}
  currentPage={page.currentPage}
  totalPages={page.lastPage}
  pagePrefix={`${linkPrefix}/${paginationPrefix}`}
  baseHref={linkPrefix}
/>
